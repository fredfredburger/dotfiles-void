#!/bin/sh

## wpdir="$HOME/wp/1366x768/"
wpdir="$HOME/wp/1920x1080/"
## wpdir="$HOME/wp/2560x1440/"

# In case more than one file is selected, pick only the first -v
p="$(find "${wpdir}" -maxdepth 1 -type f | shuf | sxiv -ifot | head -1)"

[ -z "$p" ] && notify-send "Nothing selected." && exit 0

# Backends:
#  - schemer2
#  - colorz
#  - wal
#  - haishoku
#  - colorthief
wal --backend wal -qsti "$p"

xdotool key super+F5         # update dwm
pkill -x -USR1 st            # update st
pkill -x -RTMIN+10 dwmblocks # update dwmblocks
pkill -x dunst               # update dunst
### Blocks that 'draw' on the status also need restart.
pkill -x -RTMIN+9 dwmblocks  # update battery status

notify-send -i "$p" "Theme changed." "$(basename "$p")"
